<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>pyodbc</title>
    <link href="styles.css" rel="stylesheet">
  </head>
  <body>

    <div class="navbar">
      <div><a href="index.html">Overview</a></div>
      <div class="active"><a href="api.html">API</a></div>
      <div><a href="releases.html">Releases</a></div>
    </div>
    <div class="subnav">
      <div class="active"><a href="api-module.html">module</a></div>
      <div><a href="api-connection.html">connection</a></div>
      <div><a href="api-cursor.html">cursor</a></div>
      <div><a href="api-row.html">row</a></div>
      <div><a href="api-errors.html">errors</a></div>
    </div>

    <div class="container">

      <h1>Variables</h1>

      <dl>

        <dt>version</dt>
        <dd>The module version string in <i>major.minor.patch</i> format such as
          <tt>"4.0.2"</tt>.</dd>

        <dt>apilevel</dt>
        <dd>The string constant <tt>"2.0"</tt> indicating this module supports the DB API
          level 2.0</dd>

        <dt>lowercase</dt>
        <dd>A Boolean that controls whether column names in result rows are
          lowercased. This can be changed any time and affects queries executed
          after the change. The default is <tt>False</tt>. This can be useful when
          database columns have inconsistent capitalization.</dd>

        <dt>pooling</dt>
        <dd>A Boolean indicating whether connection pooling is enabled. This is
          a global (HENV) setting, so it can only be modified before the first
          connection is made. The default is <tt>True</tt>, which enables ODBC connection
          pooling.</dd>

        <dt>threadsafety</dt>
        <dd>The value <tt>1</tt>, indicating that threads may share the module but not
          connections. Note that connections and cursors may be used by different
          threads, just not at the same time.</dd>

        <dt>paramstyle</dt>
        <dd>The string constant <tt>'qmark'</tt> to indicate parameters are identified
          using question marks.</dd>

      </dl>

      <h1 id="connect">connect</h1>

      <pre>connect(*connectionstring, **kwargs) --> Connection</pre>

      <p>Creates and returns a new connection to the database.</p>

      <p>The connection string and keywords are put together to construct an
        ODBC connection string.  Python 2 accepts both ANSI and Unicode
        strings.  (In Python 3 all strings are Unicode.)</p>

      <!-- <p>For help on connection strings, see <a href="https://code.google.com/p/pyodbc/wiki/ConnectionStrings">ConnectionStrings</a></p>
         -->
      <pre>
# a string
cnxn = connect('driver={SQL Server};server=localhost;database=test;uid=me;pwd=me2')
# keywords
cnxn = connect(driver='{SQL Server}', server='localhost', database='test', uid='me', pwd='me2')
# both
cnxn = connect('driver={SQL Server};server=localhost;database=test', uid='me', pwd='me2')
      </pre>

      <p>The DB API recommends some keywords that are not usually used in ODBC
        connection strings, so they are converted:</p>

      <table>
        <thead>
          <tr><th>keyword</th><th>converts to</th></tr>
        </thead>
        <tbody>
          <tr><td>host</td><td>server</td></tr>
          <tr><td>user</td><td>uid</td></tr>
          <tr><td>password</td><td>pwd</td></tr>
        </tbody>
      </table>

      <p>Some keywords are reserved by pyodbc and are not passed to the odbc
        driver:</p>

      <table>
        <thead>
          <tr><th>keyword</th><th>notes</th><th>default</th></tr>
        </thead>
        <tbody>
          <tr><td>ansi</td><td>If True, the driver does not support Unicode and SQLDriverConnectA should be used.</td><td>False</td></tr>
          <tr><td>attrs_before</td><td>A dictionary of connection attributes to set before connecting.</td>
            <td></td>
          </tr>
          <tr><td>autocommit</td><td>If False, Connection.commit must be called; otherwise each statement is automatically commited</td><td>False</td></tr>
          <tr>
            <td>encoding</td>
            <td>Optional encoding for the connection string.  The default is "utf-16le" when calling SQLDriverConnectW and "utf-8" when calling SQLDriverConnect (when ansi=True or if SQLDriverConnectW does not exist).</td>
            <td class="text-nowrap">utf-16le</td>
          </tr>
          <tr><td>readonly</td><td>If True, the connection is set to readonly</td><td>False</td></tr>
          <tr><td>timeout</td><td>A timeout for the connection, in seconds.  This causes the connection's SQL_ATTR_LOGIN_TIMEOUT to be set before the connection occurs.</td>
            <td></td>
          </tr>
        </tbody>
      </table>

      <h4>ansi</h4>

      <p>The ansi keyword should only be used to work around driver bugs. pyodbc will
        determine if the Unicode connection function (SQLDriverConnectW) exists and
        always attempt to call it. If the driver returns IM001 indicating it does not
        support the Unicode version, the ANSI version is tried (SQLDriverConnectA). Any
        other SQLSTATE is turned into an exception. Setting ansi to true skips the
        Unicode attempt and only connects using the ANSI version. This is useful for
        drivers that return the wrong SQLSTATE (or if pyodbc is out of date and should
        support other SQLSTATEs).</p>

      <h4>attrs_before</h4>

      <p>The <code>attrs_before</code> keyword is an optional dictionary of connection attributes.
        These will be set on the connection via SQLSetConnectAttr before a connection is made.</p>

      <p>The dictionary keys must be the integer constant defined by ODBC or the driver.  Only
        integer values are supported at this time.  Below is an example that sets the
        SQL_ATTR_PACKET_SIZE connection attribute to 32K.</p>

      <pre>
SQL_ATTR_PACKET_SIZE = 112
cnxn = connect(cstring, attrs_before={ SQL_ATTR_PACKET_SIZE : 1024 * 32 })
      </pre>


      <h1 id="dataSources">dataSources</h1>

      <pre>dataSources() -> { DSN : Description }</pre>

      <p>Returns a dictionary mapping available DSNs to their descriptions.</p>

      <p>Note: unixODBC may have a bug that only returns items from the users odbc.ini
        file without merging the system one.</p>

      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
      <script src="pyodbc.js"></script>
  </body>
</html>
